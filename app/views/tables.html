<div class="row">
    <div class="col-md-12" align="center">
        <table>
            <tr>
                <td>
                    Select table:
                </td>
                <td>
                    <select class="form-control" ng-model="estimation_table" ng-options="id for id in list"></select>
                </td>
            </tr>
            <tr ng-show="estimation_table">
                <td>
                    Select merge table:
                </td>
                <td>
                    <select class="form-control" ng-model="estimation_merge_table" ng-options="id for id in list"></select>
                </td>
            </tr>
            <tr ng-show="estimation_table">
                <td>Select left join field:</td>
                <td>
                    <select class="form-control" ng-model="left_join_fld" ng-options="fld for fld in left_fields">
                        <option value="">use index</option>
                    </select>
                </td>
            </tr>
            <tr ng-show="estimation_merge_table">
                <td>Select right join field:</td>
                <td>
                    <select class="form-control" ng-model="right_join_fld" ng-options="fld for fld in right_fields">
                        <option value="">use index</option>
                    </select>
                </td>
            </tr>
            <tr ng-show="estimation_table">
                <td>Select join type:</td>
                <td>
                    <select class="form-control" ng-model="merge_type" ng-options="typ for typ in ['left','right','outer','inner']"></select>
                </td>
            </tr>
            <tr ng-show="estimation_table">
                <td></td>
                <td>
                    <button ng-click="mergeTables()" type="button" class="btn btn-default btn-sm">
                        Merge tables
                     </button>
                </td>
            </tr>
        </table>
    </div>
</div>
    <br>


    <div class="col-md-12" align="center">
        <span ng-click="setActiveTable(id)" ng-repeat="id in list" ng-class="activeID === undefined || '{{id}}' == activeID ? '' : 'text-muted'">{{id|uppercase}}<span ng-hide="$last"> | </span></span>

        <div ng-show="activeField" class="widget stacked">
            <div class="widget-header">
                <i class="icon-th-list"></i>&nbsp;&nbsp;
                Quantiles for {{activeField.label}}
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <nvd3-line-chart
                        data="activeField.chartData"
                        id="{{activeField.label}}"
                        height="{{activeField.height}}"
                        margin="{top: 10, right: 10, bottom: 20 , left: 60}"
                        interative="true"
                        tooltips="true"
                        showXAxis="true"
                        xaxistickvalues="[0,1,2,3,4]"
                        showYAxis="true">
                    <svg></svg>
                    </nvd3-multi-bar-chart>
            </div><!-- /area-chart -->
        </div><!-- /widget-content -->
    </div>
</div>
<br>
<div class="row">
    <div class="col-md-12">
        <div ng-show="sampleRowsON" class="widget stacked widget-table action-table">
            <div class="widget-header">
                <i class="icon-th-list"></i>
                <h3>Sample Rows - {{activeID}}</h3>
            </div>

            <div class="widget-content">
                <div style="white-space:nowrap;">
                    <form class="form-inline" ng-submit="showSampleRows(activeID,sorted,descending)">
                        <div class="form-group" style="border: 0px; padding: 0px; margin: 0px; width: 59%;">
                            <input id="filterQueryInput" class="form-control" ng-model='filterQuery' placeholder="Enter filter">
                        </div>
                        <div class="form-group" style="border: 0px; padding: 0px; margin: 0px; width: 20%;">
                            <select ng-model='groupBy' class="form-control">
                                <option ng-repeat="fld in show.labels">{{fld}}</option>
                            </select>
                        </div>
                        <div class="form-group" style="border: 0px; padding: 0px; margin: 0px; width: 20%;">
                            <select ng-model='metric' class="form-control">
                                <option ng-repeat="fld in ['sum()','mean()','max()','min()','quantile()']">{{fld}}</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>

            <div class="widget-content">
                <table class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th ng-repeat="fld in show.labels">
                            <div style="white-space:nowrap;">
                                <span ng-click="showSampleRows(activeID,fld,fld==sorted?!descending:descending)" ng-if="sorted === undefined"><i class="icon-sort"></i></span>
                                <span ng-click="showSampleRows(activeID,fld,fld==sorted?!descending:descending)" ng-if="sorted == fld && !descending"><i class="icon-sort-up"></i></span>
                                <span ng-click="showSampleRows(activeID,fld,fld==sorted?!descending:descending)" ng-if="sorted == fld && descending"><i class="icon-sort-down"></i></span>
                                <span ng-click="showSampleRows(activeID,fld,fld==sorted?!descending:descending)" ng-class="sorted === undefined || fld == sorted ? '' : 'text-muted'">{{fld}}</span>
                                <span><i ng-click="addFldToQuery(fld)" class="icon-level-up"></i></span>
                            </div>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="rec in show.recs">
                        <td ng-hide="fld == 'labels'" ng-repeat="fld in rec track by $index">
                            <div ng-click="addNumToQuery(fld)" ng-if="isNumber(fld)">{{fld|number}}</div>
                            <div ng-click="addStrToQuery(fld)" ng-if="!isNumber(fld)">{{fld}}</div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <!-- /widget-content -->
        </div>
        <!-- /widget -->
        <div ng-show="summaryON" class="widget stacked widget-table action-table">
            <div class="widget-header">
                <i class="icon-th-list"></i>

                <h3>Table Summary for Dimensions - {{id}}</h3>
            </div>
            <!-- /widget-header -->
        </div>
        <!-- /widget -->
        <div ng-show="summaryON" class="widget stacked widget-table action-table">
            <div class="widget-header">
                <i class="icon-th-list"></i>

                <h3>Table Summary for Measures - {{id}}</h3>
            </div>
            <!-- /widget-header -->
            <div class="widget-content">
                <table class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th></th>
                        <th ng-repeat="fld in show.labels"><a ng-click="activateField(fld)">{{fld}}</a></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr><td>Type</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].dtype}}</td></tr>
                    <tr><td>Count</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary.count|number}}</td></tr>
                    <tr><td>Min</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary.min|number}}</td></tr>
                    <tr><td>25%</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary["25%"]|number}}</td></tr>
                    <tr><td>50%</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary["50%"]|number}}</td></tr>
                    <tr><td>75%</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary["75%"]|number}}</td></tr>
                    <tr><td>Max</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary.max|number}}</td></tr>
                    <tr><td>Mean</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary.mean|number}}</td></tr>
                    <tr><td>Std</td><td align="right" ng-repeat="fld in show.labels">{{summary[fld].summary.std|number}}</td></tr>
                    </tbody>
                </table>
            </div>
            <!-- /widget-content -->
        </div>
        <!-- /widget -->
    </div>
</div>